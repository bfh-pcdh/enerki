# Hardware used for enerki
This document describes the hardware used in the enerki project. It provides you with the information used to reproduce the setup yourself.

## What is needed
- [some kind of stationary bicycle](#bicycle)
- [a computing device](#computing-device)
- [a sensor for measuring power](#power-sensor)
- [a ANT+ dongle](#ant-dongle)
- [an endpoint for LLM](#llm-endpoint)

### Bicycle
We used a spinning bike from Schwinn that we already had available. But you can use any stationary bicycle, as long as you can screw standard bicycle pedals onto the crank.  
In theory, you can also use a smart trainer, as long as it is able to broadcast an ANT+ signal. However, we did not test that, and it may require some adjustments to the code.

### Computing device
Of course we need a device where the user interface runs. The requirements are basic: It needs to be able to run Google Chrome, and it needs an USB port and an internet connection. When using the setup on an event, it can also be useful to connect a big screen via HDMI, but this is not a must. Also, the device does not need much processing power, as it only displays a webapp and the inference is run in the cloud by default.
For correctly running the webapp, the browser used needs to support WebUSB. We chose [Google Chrome](https://www.google.com/chrome/) for availability, but the [compability chart](https://developer.mozilla.org/en-US/docs/Web/API/WebUSB_API) lists other browsers that do. As the time of writing this document, Firefox and Safari are not compatible, so you can not use them.  
In our setup, we used an older MacBook Pro, with Google Chrome.  
We were also able to run enerki on an Android Tablet (a Samsung Galaxy Tab S5e), where connecting the ANT+ dongle worked flawlessly. However, the WebApp is not optimized for this screen size with an onscreen keyboard taking up much of the screenspace. 

### Power sensor
We were using [Assioma Pro RS](https://cycling.favero.com/assioma-pro-rs/) powermeter pedals to measure the power generated by the user. For our usecase, it is not necessary to buy the expensive dual-sided pedals, the cheaper one-sided pedals work fine. Since the pedals are made for clipping in with cycling shoes, they are not very comfortable when using normal shoes. We solved this with 3D-printing an adaptor plate, using this [model](https://www.thingiverse.com/thing:3669328). We needed to cut off a small part after printing, but then these plates fit on the Assioma pedals.

You can use other powermeter hardware (e.g. powermeter cranks), as long it supports ANT+. However, we found the aforementioned pedals to be the option that is the most economical and easiest to combine with the spinning bike.  

### ANT+ dongle
For receiving the power sensors signal, we need an ANT+ dongle. We were using a [ANT+ USB Adapte from Garmin](https://www.digitec.ch/de/s1/product/garmin-usb-ant-stick-gps-geraet-2774620). For connecting with the MacBook Pro or the Android Tablet, we used a common USB A to USB C adapter, but the necessety may vary with your setup.

### LLM endpoint
enerki needs a chatbot API in order to work. Per default, we are using our [own internal inference service](https://inference.mlmp.ti.bfh.ch/). This is however only accessible in the network of the Bern University of Applied Sciences, so if you want to use another service, you need to adjust the [env file](./env.ts) accordingly.